!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.promiseful=t()}(this,function(){"use strict";function n(n){function t(n,t){return new A.Promise(function(r,e){t().then(function(t){n.push(t),r(n)}).catch(e)})}return A.reduce(n,t,[])}function t(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=P.collection.arrayize(t);return r<=0||r>=e.length?A.all(e):n(P.collection.chunk(e,r).map(function(n){return function(){return A.all(n)}})).then(P.collection.flatten)}function r(n,t){function r(n,t){return new A.Promise(function(r,e){t(n).then(r).catch(e)})}return A.reduce(n,r,t)}function e(n){return A.loop(n,function(){return!1})}function i(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),i=2;i<r;i++)e[i-2]=arguments[i];return A.loop.apply(A,[t,function(t){return n(t)}].concat(e))}function o(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),i=2;i<r;i++)e[i-2]=arguments[i];return A.loop.apply(A,[t,function(t){return!n(t)}].concat(e))}function u(n){function t(n,t){return new A.Promise(function(r,e){t().then(r).catch(function(t){n.push(t),e(n)})})}return A.reduceRejects(n,t,[])}function c(n){for(var t=arguments.length,r=Array(t>1?t-1:0),e=1;e<t;e++)r[e-1]=arguments[e];var i=P.collection.arrayize(n).map(function(n){return n.bind.apply(n,[null].concat(r))});return new K.Functions(i).attachKernel()}function a(n,t){for(var r=[],e=0;e<n;e+=1)r.push(t.bind(null,e));return new K.Functions(r).attachKernel()}function l(n,t){var r=P.collection.arrayize(n).map(function(n){return t.bind(null,n)});return new K.Functions(r).attachKernel(function(){})}function f(n,t){var r=Object.keys(n).map(function(r){return t.bind(null,n[r],r)});return new K.Functions(r).attachKernel(function(){})}function h(n,t){var r=P.collection.arrayize(n).map(function(n){return t.bind(null,n)});return new K.Functions(r).attachKernel()}function s(n,t){var r=Object.keys(n),e=r.map(function(r){return t.bind(null,n[r],r)});return new K.Functions(e).attachKernel(function(n){return r.reduce(function(t,r,e){return t[r]=n[e],t},{})})}function y(n,t){var r=P.collection.arrayize(n),e=r.map(function(n){return t.bind(null,n)});return new K.Functions(e).attachKernel(function(n){return n.reduce(function(n,t,e){return t&&n.push(r[e]),n},[])})}function p(n,t){var r=P.collection.arrayize(n),e=r.map(function(n){return t.bind(null,n)});return new K.Functions(e).attachKernel(function(n){return n.reduce(function(n,t,e){return t in n||(n[t]=[]),n[t].push(r[e]),n},{})})}function v(n,t){var r=P.collection.arrayize(n).map(function(n){return t.bind(null,n)});return new K.Functions(r).attachKernel(function(n){return n.every(function(n){return n})})}function d(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,e=P.collection.arrayize(n);return new A.Promise(function(n,i){function o(e){if(c-=1,!l)return t(e)&&(a+=1)===r?(l=!0,void n(e)):void(0===c&&(l=!0,n(!1)))}function u(n){c-=1,l||(l=!0,i(n))}var c=e.length,a=0,l=!1;e.forEach(function(n){return n().then(o,u)})})}function m(n,t){var r=P.collection.arrayize(n).map(function(n){return t.bind(null,n)});return new K.Functions(r).attachKernel(function(n){return n.some(function(n){return n})}).attachMethod("race",function(n){return d(n,function(n){return n})})}var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},g=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")},w=function(){function n(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),t}}(),k=function(n){if(Array.isArray(n)){for(var t=0,r=Array(n.length);t<n.length;t++)r[t]=n[t];return r}return Array.from(n)},P={collection:function(){function n(){g(this,n)}return w(n,null,[{key:"arrayize",value:function(n){return Array.isArray(n)?n:Array.from(n)}},{key:"chunk",value:function(t,r){var e=n.arrayize(t);if(r<=0||r>=e.length)return[e];for(var i=[],o=0;o<e.length;o+=r)i.push(e.slice(o,o+r));return i}},{key:"flatten",value:function(n){var t;return(t=[]).concat.apply(t,k(n))}}]),n}()},A=new(function(){function n(t){g(this,n),this.Promise=t}return w(n,[{key:"fulfil",value:function(n){var t=this;return"function"==typeof n?n:"object"===(void 0===n?"undefined":b(n))&&n.then&&"function"==typeof n.then?function(){return n}:function(){return t.Promise.resolve(n)}}},{key:"promise",value:function(){return arguments.length>0&&(this.Promise=arguments.length<=0?void 0:arguments[0]),this.Promise}},{key:"promisify",value:function(n){var t=this;return function(){for(var r=arguments.length,e=Array(r),i=0;i<r;i++)e[i]=arguments[i];return new t.Promise(function(t,r){e.push(function(n){for(var e=arguments.length,i=Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];n?r(n):i.length<=1?t.apply(void 0,i):t(i)}),n.apply(void 0,e)})}}},{key:"all",value:function(n){var t=this;return this.Promise.all(P.collection.arrayize(n).map(function(n){return t.fulfil(n)}).map(function(n){return n()}))}},{key:"race",value:function(n){var t=this,r=P.collection.arrayize(n);return r.length<1?this.Promise.resolve(null):this.Promise.race(r.map(function(n){return t.fulfil(n)}).map(function(n){return n()}))}},{key:"reduce",value:function(n,t,r){var e=P.collection.arrayize(n),i=this;return new this.Promise(function(n,o){function u(r,c){if(r>=e.length)n(c);else{var a=i.fulfil(e[r]);t(c,a,r).then(u.bind(this,r+1)).catch(o)}}u(0,r)})}},{key:"reduceRejects",value:function(n,t,r){var e=P.collection.arrayize(n),i=this;return new this.Promise(function(n,o){function u(r,c){if(r>=e.length)o(c);else{var a=i.fulfil(e[r]);t(c,a,r).then(n).catch(u.bind(this,r+1))}}u(0,r)})}},{key:"loop",value:function(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),i=2;i<r;i++)e[i-2]=arguments[i];var o=this.fulfil(n);return new this.Promise(function(n,r){function i(){o().then(function(r){t(r)?n(r):i()}).catch(r)}e.length>0&&t.apply(void 0,e)?n.apply(void 0,e):i()})}}]),n}())("undefined"!=typeof Promise?Promise:null),z={all:A.all.bind(A),race:A.race.bind(A),series:n,parallel:A.all.bind(A),parallelLimit:t,relay:u},F=function(){function n(t){g(this,n),this.coll=t}return w(n,[{key:"attachMethod",value:function(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),i=2;i<r;i++)e[i-2]=arguments[i];var o=this;return this[n]=function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];var u=t.apply(void 0,[o.coll].concat(r));return e.reduce(function(n,t){return n.then(t)},u)},this}},{key:"attachKernel",value:function(){for(var n=this,t=arguments.length,r=Array(t),e=0;e<t;e++)r[e]=arguments[e];return Object.keys(z).forEach(function(t){return n.attachMethod.apply(n,[t,z[t]].concat(r))}),this}}]),n}();"undefined"!=typeof Symbol&&(F.prototype[Symbol.iterator]=function(){var n=0,t=this.coll;return{next:function(){if(n>=t.length)return{done:!0};var r=t[n];return n+=1,{done:n>t.length,value:r}}}});var K={Functions:F},j={promisify:A.promisify.bind(A),all:A.all.bind(A),race:A.race.bind(A),reduce:A.reduce.bind(A),series:n,parallel:A.all.bind(A),parallelLimit:t,relay:u,waterfall:r,inject:A.reduce.bind(A),fold:A.reduce.bind(A),tryEach:u,each:l,eachOf:f,map:h,mapOf:s,filter:y,groupBy:p,every:v,some:m,applyEach:c,times:a,forever:e,until:i,whilst:o};return j.promise=function(n){return n?(A.promise(n),j):A.promise()},j});
//# sourceMappingURL=promiseful.min.js.map
