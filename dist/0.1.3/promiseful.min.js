!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):n.promiseful=r()}(this,function(){"use strict";function n(n){function r(n,r){return new K.Promise(function(t,e){r().then(function(r){n.push(r),t(n)}).catch(e)})}return K.reduce(n,r,[])}function r(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=F.collection.arrayize(r);return t<=0||t>=e.length?K.all(e):n(F.collection.chunk(e,t).map(function(n){return function(){return K.all(n)}})).then(F.collection.flatten)}function t(n,r){function t(n,r){return new K.Promise(function(t,e){r(n).then(t).catch(e)})}return K.reduce(n,t,r)}function e(n){return K.loop(n,function(){return!1})}function u(n,r){for(var t=arguments.length,e=Array(t>2?t-2:0),u=2;u<t;u++)e[u-2]=arguments[u];return K.loop.apply(K,[r,function(r){return n(r)}].concat(e))}function i(n,r){for(var t=arguments.length,e=Array(t>2?t-2:0),u=2;u<t;u++)e[u-2]=arguments[u];return K.loop.apply(K,[r,function(r){return!n(r)}].concat(e))}function o(n){function r(n,r){return new K.Promise(function(t,e){r().then(t).catch(function(r){n.push(r),e(n)})})}return K.reduceRejects(n,r,[])}function c(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];var u=F.collection.arrayize(n).map(function(n){return n.bind.apply(n,[null].concat(t))});return new S.Functions(u).attachKernel(function(){})}function a(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];var u=Object.keys(n).map(function(r){var e;return(e=n[r]).bind.apply(e,[null].concat(t))});return new S.Functions(u).attachKernel(function(){})}function l(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];var u=F.collection.arrayize(n).map(function(n){return n.bind.apply(n,[null].concat(t))});return new S.Functions(u).attachKernel()}function f(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];var u=Object.keys(n),i=u.map(function(r){var e;return(e=n[r]).bind.apply(e,[null].concat(t))});return new S.Functions(i).attachKernel(function(n){return u.reduce(function(r,t,e){return r[t]=n[e],r},{})})}function h(n,r){for(var t=[],e=0;e<n;e+=1)t.push(r.bind(null,e));return new S.Functions(t).attachKernel()}function s(n,r){var t=F.collection.arrayize(n).map(function(n){return r.bind(null,n)});return new S.Functions(t).attachKernel(function(){})}function y(n,r){var t=Object.keys(n).map(function(t){return r.bind(null,n[t],t)});return new S.Functions(t).attachKernel(function(){})}function p(n,r){var t=F.collection.arrayize(n).map(function(n){return r.bind(null,n)});return new S.Functions(t).attachKernel()}function v(n,r){var t=Object.keys(n),e=t.map(function(t){return r.bind(null,n[t],t)});return new S.Functions(e).attachKernel(function(n){return t.reduce(function(r,t,e){return r[t]=n[e],r},{})})}function d(n,r){var t=F.collection.arrayize(n),e=t.map(function(n){return r.bind(null,n)});return new S.Functions(e).attachKernel(function(n){return n.reduce(function(n,r,e){return r&&n.push(t[e]),n},[])})}function m(n,r){var t=F.collection.arrayize(n),e=t.map(function(n){return r.bind(null,n)});return new S.Functions(e).attachKernel(function(n){return n.reduce(function(n,r,e){return r in n||(n[r]=[]),n[r].push(t[e]),n},{})})}function b(n,r){var t=F.collection.arrayize(n).map(function(n){return r.bind(null,n)});return new S.Functions(t).attachKernel(function(n){return n.every(function(n){return n})})}function g(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,e=F.collection.arrayize(n);return new K.Promise(function(n,u){function i(e){if(c-=1,!l)return r(e)&&(a+=1)===t?(l=!0,void n(e)):void(0===c&&(l=!0,n(!1)))}function o(n){c-=1,l||(l=!0,u(n))}var c=e.length,a=0,l=!1;e.forEach(function(n){return n().then(i,o)})})}function w(n,r){var t=F.collection.arrayize(n).map(function(n){return r.bind(null,n)});return new S.Functions(t).attachKernel(function(n){return n.some(function(n){return n})}).attachMethod("race",function(n){return g(n,function(n){return n})})}var k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},A=function(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")},P=function(){function n(n,r){for(var t=0;t<r.length;t++){var e=r[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(r,t,e){return t&&n(r.prototype,t),e&&n(r,e),r}}(),z=function(n){if(Array.isArray(n)){for(var r=0,t=Array(n.length);r<n.length;r++)t[r]=n[r];return t}return Array.from(n)},F={collection:function(){function n(){A(this,n)}return P(n,null,[{key:"arrayize",value:function(n){return Array.isArray(n)?n:Array.from(n)}},{key:"chunk",value:function(r,t){var e=n.arrayize(r);if(t<=0||t>=e.length)return[e];for(var u=[],i=0;i<e.length;i+=t)u.push(e.slice(i,i+t));return u}},{key:"flatten",value:function(n){var r;return(r=[]).concat.apply(r,z(n))}}]),n}()},K=new(function(){function n(r){A(this,n),this.Promise=r}return P(n,[{key:"fulfil",value:function(n){var r=this;return"function"==typeof n?n:"object"===(void 0===n?"undefined":k(n))&&n.then&&"function"==typeof n.then?function(){return n}:function(){return r.Promise.resolve(n)}}},{key:"promise",value:function(){return arguments.length>0&&(this.Promise=arguments.length<=0?void 0:arguments[0]),this.Promise}},{key:"promisify",value:function(n){var r=this;return function(){for(var t=arguments.length,e=Array(t),u=0;u<t;u++)e[u]=arguments[u];return new r.Promise(function(r,t){e.push(function(n){for(var e=arguments.length,u=Array(e>1?e-1:0),i=1;i<e;i++)u[i-1]=arguments[i];n?t(n):u.length<=1?r.apply(void 0,u):r(u)}),n.apply(void 0,e)})}}},{key:"all",value:function(n){var r=this;return this.Promise.all(F.collection.arrayize(n).map(function(n){return r.fulfil(n)}).map(function(n){return n()}))}},{key:"race",value:function(n){var r=this,t=F.collection.arrayize(n);return t.length<1?this.Promise.resolve(null):this.Promise.race(t.map(function(n){return r.fulfil(n)}).map(function(n){return n()}))}},{key:"reduce",value:function(n,r,t){var e=F.collection.arrayize(n),u=this;return new this.Promise(function(n,i){function o(t,c){if(t>=e.length)n(c);else{var a=u.fulfil(e[t]);r(c,a,t).then(o.bind(this,t+1)).catch(i)}}o(0,t)})}},{key:"reduceRejects",value:function(n,r,t){var e=F.collection.arrayize(n),u=this;return new this.Promise(function(n,i){function o(t,c){if(t>=e.length)i(c);else{var a=u.fulfil(e[t]);r(c,a,t).then(n).catch(o.bind(this,t+1))}}o(0,t)})}},{key:"loop",value:function(n,r){for(var t=arguments.length,e=Array(t>2?t-2:0),u=2;u<t;u++)e[u-2]=arguments[u];var i=this.fulfil(n);return new this.Promise(function(n,t){function u(){i().then(function(t){r(t)?n(t):u()}).catch(t)}e.length>0&&r.apply(void 0,e)?n.apply(void 0,e):u()})}}]),n}())("undefined"!=typeof Promise?Promise:null),j={all:K.all.bind(K),race:K.race.bind(K),series:n,parallel:K.all.bind(K),parallelLimit:r,relay:o},O=function(){function n(r){A(this,n),this.coll=r}return P(n,[{key:"attachMethod",value:function(n,r){for(var t=arguments.length,e=Array(t>2?t-2:0),u=2;u<t;u++)e[u-2]=arguments[u];var i=this;return this[n]=function(){for(var n=arguments.length,t=Array(n),u=0;u<n;u++)t[u]=arguments[u];var o=r.apply(void 0,[i.coll].concat(t));return e.reduce(function(n,r){return n.then(r)},o)},this}},{key:"attachKernel",value:function(){for(var n=this,r=arguments.length,t=Array(r),e=0;e<r;e++)t[e]=arguments[e];return Object.keys(j).forEach(function(r){return n.attachMethod.apply(n,[r,j[r]].concat(t))}),this}}]),n}();"undefined"!=typeof Symbol&&(O.prototype[Symbol.iterator]=function(){var n=0,r=this.coll;return{next:function(){if(n>=r.length)return{done:!0};var t=r[n];return n+=1,{done:n>r.length,value:t}}}});var S={Functions:O},E={promisify:K.promisify.bind(K),all:K.all.bind(K),race:K.race.bind(K),reduce:K.reduce.bind(K),series:n,parallel:K.all.bind(K),parallelLimit:r,relay:o,waterfall:t,inject:K.reduce.bind(K),fold:K.reduce.bind(K),tryEach:o,each:s,eachOf:y,map:p,mapOf:v,filter:d,groupBy:m,every:b,some:w,mapValues:v,applyEach:c,applyEachOf:a,applyMap:l,applyMapOf:f,times:h,forever:e,until:u,whilst:i};return E.promise=function(n){return n?(K.promise(n),E):K.promise()},E});
//# sourceMappingURL=promiseful.min.js.map
